{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from \"axios\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst refs = {\n    formEl: document.querySelector('.js-search-form'),\n    imgEl: document.querySelector('.js-image-container'),\n    loaderEl: document.querySelector('.loader'),\n    loadMoreBtn: document.querySelector('.load-more-btn'), \n    loaderBottom: document.querySelector('.loadMore')\n};\n\nlet currentPage = 1;\nlet currentQuery = '';\n\nif (refs.formEl) {\n    refs.formEl.addEventListener('submit', onFormSubmit);\n}\n\nif (refs.loadMoreBtn) {\n    refs.loadMoreBtn.addEventListener('click', loadMoreImages);\n}\n\nasync function onFormSubmit(e) {\n    e.preventDefault();\n    currentPage = 1;\n    currentQuery = e.target.elements.text.value.trim();\n\n    if (!currentQuery) {\n        iziToast.error({\n            position: \"topRight\",\n            message: 'Please enter a search query!',\n        });\n        return;\n    }\n\n    toggleLoader(true);\n\n    try {\n        const data = await getImg(currentQuery, currentPage);\n        renderImg(data);\n        if (data.hits.length === 0) {\n            toggleLoader(false);\n            toggleLoadMoreButton(false);\n            // Show message about end of collection\n        } else {\n            toggleLoadMoreButton(true);\n            toggleLoader(false);\n            currentPage++;\n        }\n    } catch (error) {\n        console.error('Error fetching images:', error);\n        toggleLoader(false);\n        toggleLoadMoreButton(false);\n        clearGallery();\n        iziToast.error({\n            position: \"topRight\",\n            message: 'Failed to fetch images. Please try again later.',\n        });\n    } finally {\n        e.target.elements.text.value = '';\n    }\n}\n\n\nasync function loadMoreImages() {\n    try {\n        toggleLoadMoreButton(false);\n        toggleLoadMore(true);\n        const data = await getImg(currentQuery, currentPage);\n        renderImg(data);\n        \n        if (data.hits.length === 0) {\n           \n           toggleLoadMore(false);\n            showEndOfSearchMessage();\n        } else {\n            toggleLoadMoreButton(true);\n            currentPage++;\n        }\n    } catch (error) {\n        \n        console.error('Error fetching more images:', error);\n    }\n}\n\nfunction showEndOfSearchMessage() {\n    const endOfSearchMessage = document.createElement('p');\n    endOfSearchMessage.textContent = \"We're sorry, but you've reached the end of search results.\";\n    refs.imgEl.insertAdjacentElement('beforebegin', endOfSearchMessage);\n}\n\n\nasync function getImg(query, page = 1) {\n    const BASE_URL = 'https://pixabay.com/api/';\n    const API_KEY = '42295751-6e09ed05d50a99192d667c3e9';\n\n    try {\n        const response = await axios.get(BASE_URL, {\n            params: {\n                key: API_KEY,\n                q: query,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                page: page,\n                per_page: 15\n            }\n        });\n\n        return response.data;\n    } catch (error) {\n        throw new Error('Failed to fetch images');\n    }\n}\n\nfunction imgTemplate(photo) {\n    return `\n        <a href=\"${photo.largeImageURL}\" class=\"photo-container\" data-lightbox=\"photos\">\n            <img\n                src=\"${photo.webformatURL}\"\n                alt=\"${photo.tags}\"\n                class=\"photo\"\n            />\n            \n            <div class=\"photo-body\">\n                <p class=\"photo-name\">Likes ${photo.likes}</p>\n                <p class=\"photo-name\">Views ${photo.views}</p>\n                <p class=\"photo-name\">Comments ${photo.comments}</p>\n                <p class=\"photo-name\">Downloads ${photo.downloads}</p>\n            </div>\n        </a>\n    `;\n}\n\nfunction renderImg(data) {\n   \n    if (currentPage === 1) {\n        clearGallery();\n    }\n    refs.imgEl.innerHTML += data.hits.map(img => imgTemplate(img)).join('');\n\n    const lightbox = new SimpleLightbox('[data-lightbox=\"photos\"]');\n    lightbox.refresh();\n\n    toggleLoadMoreButton(true);\n    toggleLoadMore(false);\n    smoothScrollToNextImages();\n}\n\nfunction smoothScrollToNextImages() {\n    const galleryItem = document.querySelector('.photo-container'); \n    if (galleryItem) {\n        const cardHeight = galleryItem.getBoundingClientRect().height; \n        const scrollAmount = cardHeight * 2; \n\n        window.scrollBy({\n            top: scrollAmount,\n            behavior: 'smooth' \n        });\n    }\n}\nfunction clearGallery() {\n    refs.imgEl.innerHTML = '';\n}\n\nfunction toggleLoader(isVisible) {\n    refs.loaderEl.style.display = isVisible ? 'inline-block' : 'none';\n    refs.loaderEl.style.bottom = isVisible ? '50%' : '50%';\n}\n\nfunction toggleLoadMoreButton(isVisible) {\n    refs.loadMoreBtn.style.display = isVisible ? 'block' : 'none';\n}\nfunction toggleLoadMore(isVisible) {\n    refs.loaderBottom.style.display = isVisible ? 'block' : 'none';\n    \n}"],"names":["refs","currentPage","currentQuery","onFormSubmit","loadMoreImages","iziToast","toggleLoader","data","getImg","renderImg","toggleLoadMoreButton","error","clearGallery","toggleLoadMore","showEndOfSearchMessage","endOfSearchMessage","query","page","BASE_URL","API_KEY","axios","imgTemplate","photo","img","SimpleLightbox","smoothScrollToNextImages","galleryItem","scrollAmount","isVisible"],"mappings":"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"}